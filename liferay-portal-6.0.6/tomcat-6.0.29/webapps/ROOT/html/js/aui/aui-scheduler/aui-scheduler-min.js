AUI.add("aui-scheduler-base",function(ak){var W=ak.Lang,aI=W.isString,G=W.isObject,b=W.isArray,f=W.isDate,P=W.isNumber,O=function(A){return(A instanceof ak.Scheduler);},x=function(A){return(A instanceof ak.SchedulerView);},ah=function(A){return(A instanceof ak.SchedulerEvent);},z=function(A){return(ak.SchedulerCalendar&&(A instanceof ak.SchedulerCalendar));},k=ak.DataType.DateMath,ad=ak.WidgetStdMod,aG="-",ab=".",s="",t=" ",v="scheduler-base",aq="data-view-name",M="activeView",r="boundingBox",aH="clearfix",L="controls",at="controlsNode",aw="current",aj="currentDate",af="currentDateNode",ar="date",ai="dateFormat",aC="day",ap="endDate",aJ="events",I="firstDayOfWeek",aO="hd",aF="headerNode",p="helper",Z="icon",m="iconNextNode",aB="iconPrevNode",aM="locale",h="month",o="name",X="nav",T="navNode",q="next",e="nextDate",aE="prev",au="prevDate",aN="rendered",S="scheduler",ax="srcNode",aL="startDate",J="strings",az="template",g="today",al="todayNode",B="triggerNode",E="view",aP="views",ae="viewsNode",V="week",w="year",aA="navigationDateFormat",U="eventRecorder",F=ak.ClassNameManager.getClassName,am=F(p,aH),l=F(Z),ay=F(v,L),aa=F(v,aw,ar),j=F(v,aO),ac=F(v,Z,q),H=F(v,Z,aE),aK=F(v,X),D=F(v,g),ag=F(v,E),u=F(v,aP),i=F(v,E,s),y=F(v,E,aC),a=F(v,E,h),c=F(v,E,V),ao=F(v,E,w),K=F(S,E,s),av='<div class="'+ay+'"></div>',C='<div class="'+aa+'"></div>',d='<div class="'+j+'"></div>',aQ='<a href="#" class="'+[l,ac].join(t)+'">Next</a>',an='<a href="#" class="'+[l,H].join(t)+'">Prev</a>',n='<div class="'+aK+'"></div>',Y='<a href="#" class="'+D+'">{today}</a>',aD='<a href="#" class="'+[ag,i].join(t)+'{name}" data-view-name="{name}">{label}</a>',Q='<div class="'+u+'"></div>';var R=function(){};R.ATTRS={events:{value:[],setter:"_setEvents",validator:b}};ak.mix(R.prototype,{addEvent:function(aR){var A=this;var aS=A.get(aJ);if(ak.Array.indexOf(aS,aR)>-1){ak.Array.removeItem(aS,aR);}aS.push(aR);A.set(aJ,aS);},addEvents:function(aR){var A=this;ak.Array.each(A._normalizeEvents(aR),ak.bind(A.addEvent,A));},eachEvent:function(aS){var A=this;var aR=A.get(aJ);ak.Array.each(aR,aS,A);},removeEvent:function(aR){var A=this;var aS=A.get(aJ);ak.Array.removeItem(aS,aR);A.set(aJ,aS);},removeEvents:function(aR){var A=this;ak.Array.each(A._normalizeEvents(aR),ak.bind(A.removeEvent,A));},_normalizeEvents:function(aS){var A=this;var aR=[];aS=ak.Array(aS);ak.Array.each(aS,function(aT,aU){if(ah(aT)){aR.push(aT);}else{if(z(aT)){aR=aR.concat(A._normalizeEvents(aT.get(aJ)));}else{aT=new ak.SchedulerEvent(aT);aR.push(aT);}}if(O(A)){aT.set(S,A);}});return aR;},_setEvents:function(aR){var A=this;return A._normalizeEvents(aR);}});ak.SchedulerEventSupport=R;var N=ak.Component.create({NAME:v,ATTRS:{activeView:{validator:x},eventRecorder:{setter:"_setEventRecorder"},strings:{value:{day:"Day",month:"Month",today:"Today",week:"Week",year:"Year"}},navigationDateFormat:{getter:function(aS){var A=this;var aR=A.get(M);if(aR){return aR.get(aA);}return aS;},value:"%A - %d %b %Y",validator:aI},views:{setter:"_setViews",value:[]},currentDate:{valueFn:function(){return new Date();},validator:f},firstDayOfWeek:{value:0,validator:P},controlsNode:{valueFn:function(){return ak.Node.create(av);}},currentDateNode:{valueFn:function(){return ak.Node.create(C);}},headerNode:{valueFn:function(){return ak.Node.create(d);}},iconNextNode:{valueFn:function(){return ak.Node.create(aQ);}},iconPrevNode:{valueFn:function(){return ak.Node.create(an);}},navNode:{valueFn:function(){return ak.Node.create(n);}},todayNode:{valueFn:function(){return ak.Node.create(this._processTemplate(Y));}},viewsNode:{valueFn:function(){return ak.Node.create(Q);}}},HTML_PARSER:{controlsNode:ab+ay,currentDateNode:ab+aa,headerNode:ab+j,iconNextNode:ab+ac,iconPrevNode:ab+H,navNode:ab+aK,todayNode:ab+D,viewsNode:ab+u},UI_ATTRS:[aj],AUGMENTS:[ak.SchedulerEventSupport,ak.WidgetStdMod],prototype:{viewStack:null,initializer:function(){var A=this;A.viewStack={};A.controlsNode=A.get(at);A.currentDateNode=A.get(af);A.iconNextNode=A.get(m);A.iconPrevNode=A.get(aB);A.navNode=A.get(T);A.schedulerHeaderNode=A.get(aF);A.todayNode=A.get(al);A.viewsNode=A.get(ae);A.after({render:A._afterRender,activeViewChange:A._afterActiveViewChange});},bindUI:function(){var A=this;A._bindDelegate();},syncUI:function(){var A=this;A.syncStdContent();},flushEvents:function(){var A=this;ak.Array.each(A.get(aJ),function(aR,aS){aR.eachRepeatedEvent(function(aU,aT){delete aU._filtered;});delete aR._filtered;});},getEventsByDay:function(aR){var A=this;aR=k.safeClearTime(aR);return A._getEvents(aR,function(aS){return k.compare(aS.getClearStartDate(),aR);});},getIntersectEvents:function(aR){var A=this;aR=k.safeClearTime(aR);return A._getEvents(aR,function(aT){var aS=aT.getClearStartDate();var aU=aT.getClearEndDate();return(k.compare(aR,aS)||k.compare(aR,aU)||k.between(aR,aS,aU));});},sortEventsByDateAsc:function(aR){var A=this;aR.sort(function(aV,aT){var aU=aV.get(ap);var aS=aT.get(ap);var aX=aV.get(aL);var aW=aT.get(aL);if(k.after(aX,aW)||k.compare(aX,aW)&&k.before(aU,aS)){return 1;}else{return -1;}});},getViewByName:function(aR){var A=this;return A.viewStack[aR];},getStrings:function(){var A=this;return A.get(J);},getString:function(aR){var A=this;return A.getStrings()[aR];},renderView:function(aR){var A=this;if(aR){aR.show();if(!aR.get(aN)){var aS=aR.get(o);if(!A.bodyNode){A.setStdModContent(ad.BODY,s);}aR.render(A.bodyNode);}}},plotViewEvents:function(aR){var A=this;aR.plotEvents(A.get(aJ));},syncEventsUI:function(){var A=this;A.plotViewEvents(A.get(M));},_afterActiveViewChange:function(aT){var aR=this;if(aR.get(aN)){var aS=aT.newVal;var A=aT.prevVal;if(A){A.hide();}aR.renderView(aS);}},_afterRender:function(aR){var A=this;A.renderView(A.get(M));},_bindDelegate:function(){var A=this;A.viewsNode.delegate("click",A._onClickViewTrigger,ab+ag,A);A.controlsNode.delegate("click",A._onClickPrevIcon,ab+H,A);A.controlsNode.delegate("click",A._onClickNextIcon,ab+ac,A);A.controlsNode.delegate("click",A._onClickToday,ab+D,A);},_createViewTriggerNode:function(aR){var A=this;
if(!aR.get(B)){var aS=aR.get(o);aR.set(B,ak.Node.create(ak.substitute(aD,{name:aS,label:(A.getString(aS)||aS)})));}return aR.get(B);},_getEvents:function(aR,aT){var A=this;var aS=A.get(aJ);var aU=[];ak.Array.each(aS,function(aV,aW){if(aT.apply(A,[aV])){aU.push(aV);}else{if(aV.isRepeatableDate(aR)){var aX=aV.repeatByDate(aR);aU.push(aX);}}});A.sortEventsByDateAsc(aU);return aU;},_onClickToday:function(aR){var A=this;A.set(aj,A.get(M).getToday());aR.preventDefault();},_onClickNextIcon:function(aR){var A=this;A.set(aj,A.get(M).get(e));aR.preventDefault();},_onClickPrevIcon:function(aR){var A=this;A.set(aj,A.get(M).get(au));aR.preventDefault();},_onClickViewTrigger:function(aS){var A=this;var aT=aS.currentTarget;var aU=aT.attr(aq);var aR=A.getViewByName(aU);A.set(M,aR);aS.preventDefault();},_processTemplate:function(aR){var A=this;return ak.substitute(aR,A.getStrings());},_setEventRecorder:function(aR){var A=this;if(aR){aR.set(S,A);}},_setViews:function(aS){var A=this;var aR=[];ak.Array.each(aS,function(aT){if(x(aT)&&!aT.get(aN)){aT.set(S,A);aR.push(aT);A.viewStack[aT.get(o)]=aT;}});if(!A.get(M)){A.set(M,aS[0]);}return aR;},syncStdContent:function(){var A=this;var aR=A.get(aP);A.navNode.append(A.iconPrevNode);A.navNode.append(A.iconNextNode);A.controlsNode.append(A.todayNode);A.controlsNode.append(A.navNode);A.controlsNode.append(A.currentDateNode);ak.Array.each(aR,function(aS){A.viewsNode.append(A._createViewTriggerNode(aS));});A.schedulerHeaderNode.append(A.controlsNode);A.schedulerHeaderNode.append(A.viewsNode);A.schedulerHeaderNode.addClass(am);A.setStdModContent(ad.HEADER,A.schedulerHeaderNode.getDOM());},_uiSetCurrentDate:function(aV){var aS=this;var aR=aS.get(aA);var A=aS.get(aM);var aU=ak.DataType.Date.format(aV,{format:aR,locale:A});aS.currentDateNode.html(aU);if(aS.get(aN)){var aT=aS.get(M);if(aT){aT._uiSetCurrentDate(aV);}aS.syncEventsUI();}}}});ak.Scheduler=N;},"1.0.1",{requires:["aui-scheduler-view","datasource"],skinnable:true});AUI.add("aui-scheduler-view",function(b5){var cm=b5.Lang,cD=cm.isObject,bU=cm.isString,aU=cm.isBoolean,aG=cm.isNumber,be=function(A){return A==0?0:(A<0?-1:1);},aK=function(A,cH){return Math.max(Math.abs(A),cH)*be(A);},bH=function(A){return parseFloat(A)||0;},bJ=function(cH,A){return Math.round(cH/A)*A;},aq=b5.DataType.DateMath,b1=b5.WidgetStdMod,aL=aq.WEEK_LENGTH,bL="scheduler-view",aF="scheduler-view-day",b9="scheduler-view-week",cw="scheduler-view-month",bG="activeView",a6="am",u="borderLeftWidth",cd="borderRightWidth",aQ="boundingBox",q="children",bx="childNodes",ag="col",I="colblank",y="coldata",aI="colday",a="colgrid",bs="colmonth",W="colspan",m="coltime",cr="columnNode",ax="colDaysNode",b7="colHeaderDaysNode",aO="container",aM="content",ct="contentBox",av="createDocumentFragment",bb="currentDate",by="data",ba="dateFormat",cj="day",U="days",E="delegateConfig",bE="disabled",X="div",bk="division",ab="down",cb="dragNode",bT="duration",aA="endDate",a2="event",bZ="events",cF="eventRecorder",s="eventWidth",aH="first",ca="firstDayOfWeek",a8="grid",cE="hd",b3="header",a9="headerDateFormat",cA="headerTableNode",bO="height",aP="host",aE="hourHeight",v="icon",ak="isoTime",bf="labelAM",aC="labelPM",aR="left",ay="locale",ac="marker",a4="markercell",aX="markercellsNode",bM="markercellNode",L="markers",bD="month",a7="monthContainerNode",bB="navigationDateFormat",aN="next",bK="nextDate",cG="node",aj="nomonth",ar="noscroll",b2="offsetHeight",K="offsetTop",b4="offsetWidth",ch="ownerDocument",b6="pad",co="parentEvent",R="parentNode",an="pm",aa="prevDate",br="proxy",ah="px",aS="rendered",b0="repeated",aY="right",bp="row",r="scheduler",aD="scheduler-event",Y="scrollable",T="shim",b8="startDate",aT="table",cu="tableColNode",j="tableDataNode",D="tableGridNode",bv="tableNode",bV="tableTimeNode",bt="tbody",e="td",bm="time",ai="timesNode",g="title",al="today",bq="top",cB="tr",z="trigger",cp="week",bz="width",bI="-",k="a",bN=".",bF="",bA="%",V=" ",F=b5.ClassNameManager.getClassName,bl=F(bL,ar),ad=F(bL,Y);var aW=b5.Component.create({NAME:bL,ATTRS:{bodyContent:{value:bF},height:{value:600},isoTime:{value:false,validator:aU},name:{value:bF,validator:bU},navigationDateFormat:{value:"%A - %d %b %Y",validator:bU},nextDate:{getter:"getNextDate",readOnly:true},prevDate:{getter:"getPrevDate",readOnly:true},scheduler:{lazyAdd:false,setter:"_setScheduler"},scrollable:{value:true,validator:aU},triggerNode:{setter:b5.one},visible:{value:false}},BIND_UI_ATTRS:[Y],prototype:{initializer:function(){var A=this;A.after("render",A._afterRender);},syncUI:function(){var A=this;A.syncStdContent();},adjustCurrentDate:function(){var A=this;var cI=A.get(r);var cH=cI.get(bb);cI.set(bb,cH);},flushViewCache:function(){},getNextDate:function(){},getPrevDate:function(){},getToday:function(){return aq.clearTime(new Date());},limitDate:function(cH,cI){var A=this;if(aq.after(cH,cI)){cH=aq.clone(cI);}return cH;},plotEvents:function(A){},syncStdContent:function(){},syncEventUI:function(A){},_uiSetCurrentDate:function(A){},_afterRender:function(cI){var A=this;var cH=A.get(r);A.adjustCurrentDate();A._uiSetScrollable(A.get(Y));},_setScheduler:function(cI){var A=this;var cH=A.get(r);if(cH){A.removeTarget(cH);}if(cI){A.addTarget(cI);cI.after("eventsChange",b5.bind(A.flushViewCache,A));}return cI;},_uiSetScrollable:function(cI){var A=this;var cH=A.bodyNode;if(cH){cH.toggleClass(ad,cI);cH.toggleClass(bl,!cI);}},_uiSetVisible:function(cH){var A=this;aW.superclass._uiSetVisible.apply(this,arguments);if(cH&&A.get(aS)){A.adjustCurrentDate();}}}});b5.SchedulerView=b5.Base.create(bL,aW,[b5.WidgetStdMod]);var O=function(A,cH){return function(cJ){var cI=cJ.all(A);return(cI.size()>=cH)?cI:null;};},aJ=F(aD),bh=F(aD,bE),bQ=F(aD,br),B=F(bL,y),c=F(bL,a),Q=F(r,al),ap=F(r,al,cE),ce=F(bL,a8),cf=F(bL,a8,aO),ci=F(bL,a4),M=F(bL,L),bj=F(bL,ac,bk),bw=F(bL,aT),cl=F(bL,cj,b3,aT),t=F(bL,cj,b3,cj),bi=F(bL,cj,b3,cj,b6,aY),bS=F(bL,cj,b3,cj,aH),a1=F(bL,cj,b3,ag),cy=F(bL,aT,ag),aB=F(bL,aT,ag,T),P=F(bL,aT,I),H=F(bL,aT,aI),n=F(bL,aT,aI,b3),cq=F(bL,aT,m),bo=F(bL,aT,bm),ae='<div class="'+ci+'">'+'<div class="'+bj+'"></div>'+"</div>",au='<table class="'+bw+'">'+"<tbody>"+'<tr class="'+c+'" height="1">'+'<td height="0" class="'+[cy,P].join(V)+'"></td>'+'<td class="'+cf+'" colspan="1">'+'<div class="'+ce+'">'+'<div class="'+M+'"></div>'+"</div>"+"</td>"+"</tr>"+'<tr class="'+B+'">'+'<td class="'+[cy,cq].join(V)+'"></td>'+"</tr>"+"</tbody>"+"</table>",bd='<td class="'+[cy,H].join(V)+'">'+'<div class="'+aB+'"></div>'+"</td>",i='<div class="'+bo+'">{hour}</div>',aw='<table class="'+cl+'">'+"<tbody>"+'<tr class="'+a1+'"></tr>'+"</tbody>"+"</table>",bg='<th class="'+t+'"><a href="#">&nbsp;</a></th>',at='<td class="'+[t,bS].join(V)+'"></td>',w='<th class="'+[t,bi].join(V)+'">&nbsp;</th>';
var cz=b5.Component.create({NAME:aF,ATTRS:{bodyContent:{value:bF},days:{value:1,validator:aG},delegateConfig:{value:{},setter:function(cH){var A=this;return b5.merge({bubbleTargets:A,container:A.get(aQ),nodes:bN+aJ,invalid:"input, select, button, a, textarea, "+bN+bh},cH||{});},validator:cD},headerDateFormat:{value:"%a %d/%m",validator:bU},name:{value:cj},hourHeight:{value:52,validator:aG},eventWidth:{value:95,validator:aG},headerTableNode:{valueFn:function(){return b5.Node.create(aw);}},tableNode:{valueFn:function(){return b5.Node.create(au);}},colDaysNode:{valueFn:"_valueColDaysNode"},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},markercellsNode:{valueFn:"_valueMarkercellsNode"},timesNode:{valueFn:"_valueTimesNode"}},HTML_PARSER:{colHeaderDaysNode:O(bN+t,2),colDaysNode:O(bN+H,1),markercellsNode:O(bN+ci,24),timesNode:O(bN+bo,24),headerTableNode:bN+cl,tableNode:bN+bw},EXTENDS:b5.SchedulerView,prototype:{initializer:function(){var A=this;A.colDaysNode=A.get(ax);A.colHeaderDaysNode=A.get(b7);A.headerTableNode=A.get(cA);A.markercellsNode=A.get(aX);A.tableNode=A.get(bv);A.timesNode=A.get(ai);A.colShimNodes=A.colDaysNode.all(bN+aB);A.colDataNode=A.tableNode.one(bN+B);A.colTimeNode=A.tableNode.one(bN+cq);A.dayHeaderColNode=A.headerTableNode.one(bN+a1);A.gridContainer=A.tableNode.one(bN+cf);A.markersNode=A.tableNode.one(bN+M);},renderUI:function(){var A=this;A.colTimeNode.setContent(A.timesNode);A.markersNode.setContent(A.markercellsNode);A.colDaysNode.appendTo(A.colDataNode);A.colHeaderDaysNode.appendTo(A.dayHeaderColNode);},bindUI:function(){var A=this;A.headerTableNode.delegate("click",b5.bind(A._onClickDaysHeader,A),bN+t);A.colDataNode.delegate("mousedown",b5.bind(A._onMouseDownTableCol,A),bN+cy);A.colDataNode.delegate("mouseup",b5.bind(A._onMouseUpTableCol,A),bN+cy);A.colDataNode.delegate("mousemove",b5.bind(A._onMouseMoveTableCol,A),bN+cy);A.on("drag:end",A._onEventDragEnd);A.on("drag:start",A._onEventDragStart);A.on("drag:align",A._dragAlign);A.on("drag:tickAlignX",A._dragTickAlignX);A.on("drag:tickAlignY",A._dragTickAlignY);},syncUI:function(){var A=this;cz.superclass.syncUI.apply(this,arguments);A.gridContainer.attr(W,A.get(U));A._setupDragDrop();},syncStdContent:function(){var A=this;A.setStdModContent(b1.BODY,A.tableNode.getDOM());A.setStdModContent(b1.HEADER,A.headerTableNode.getDOM());},calculateTopByDate:function(cJ){var cH=this;var A=cH.get(aE);var cI=cJ.getHours();var cK=cJ.getMinutes();var cL=cJ.getSeconds();return((cI*60)+cK+(cL/60))*(A/60);},calculateHoursByTop:function(cK){var cH=this;var A=cH.get(aE);var cM=bH((cK/A).toFixed(2));var cL=0;var cJ=Math.floor((cM*100)%100*0.6);var cI=Math.floor(cM);return[cI,cJ,cL];},getNextDate:function(){var A=this;var cI=A.get(r);var cH=cI.get(bb);return aq.add(cH,aq.DAY,1);},getPrevDate:function(){var A=this;var cI=A.get(r);var cH=cI.get(bb);return aq.subtract(cH,aq.DAY,1);},getColumnByDate:function(cI){var A=this;var cJ=A.get(r);var cH=aq.safeClearTime(cJ.get(bb));var cK=aq.getDayOffset(aq.safeClearTime(cI),cH);return A.colDaysNode.item(cK);},getDateByColumn:function(cI){var A=this;var cJ=A.get(r);var cH=aq.safeClearTime(cJ.get(bb));return aq.add(cH,aq.DAY,cI);},plotEvents:function(cI){var A=this;var cH=A.get(r);A.colShimNodes.each(function(cM,cL){var cK=A.getDateByColumn(cL);var cJ=cH.getEventsByDay(cK);cM.empty();b5.Array.each(cJ,function(cN,cO){if(!cN.isDayOverlapEvent()){cM.append(cN.get(cG));cN.set(cr,cM.get(R));A.syncEventTopUI(cN);A.syncEventHeightUI(cN);}});A.syncEventsIntersectionUI(cJ);});},syncColumnsUI:function(){var A=this;A.colDaysNode.each(function(cJ,cI){var cH=A.getDateByColumn(cI);cJ.toggleClass(Q,aq.isToday(cH));});},syncDaysHeaderUI:function(){var cI=this;var cK=cI.get(r);var cJ=cK.get(bb);var cH=cI.get(a9);var A=cI.get(ay);cI.colHeaderDaysNode.all(k).each(function(cN,cM){var cL=aq.add(cJ,aq.DAY,cM);var cO=b5.DataType.Date.format(cL,{format:cH,locale:A});cN.toggleClass(ap,aq.isToday(cL));cN.html(cO);});},syncEventsIntersectionUI:function(cH){var A=this;var cI=A.get(r);var cJ=A.get(s);cI.flushEvents();b5.Array.each(cH,function(cL,cM){var cO=A.findEventIntersections(cL,cH);var cN=cO.length;var cK=(cJ/cN);b5.Array.each(cO,function(cQ,cR){var cP=cQ.get(cG);var cT=cK*cR;var cS=cK*1.7;if(cR==(cN-1)){cS=cJ-cT;}cP.setStyle(bz,cS+bA);cP.setStyle(aR,cT+bA);var cU=cP.get(R);if(cU){cU.insert(cP,cR);}cQ._filtered=true;});});},syncEventHeightUI:function(cI){var cH=this;var A=cH.get(aE);var cK=cH.calculateTopByDate(cI.get(b8));var cJ=cH.calculateTopByDate(cI.get(aA));cI.get(cG).set(b2,Math.max(cJ-cK,A/2));},syncEventRecorderUI:function(cJ){var A=this;var cI=A.get(r);var cK=cI.get(cF);var cH=cK.get(cG);if(cJ&&!cH.inDoc()){cJ.append(cH);}A.syncEventTopUI(cK);A.syncEventHeightUI(cK);},syncEventTopUI:function(cI){var cH=this;var A=cI.get(cG);var cJ=cH.calculateTopByDate(cI.get(b8));A.setStyle(bq,cJ+ah);},findEventIntersections:function(cH,cI){var A=this;var cJ=[];b5.Array.each(cI,function(cL,cK){if(!cH._filtered&&!cL.isDayOverlapEvent()&&cH.intersectHours(cL)){cJ.push(cL);}});return cJ;},_createEvents:function(){var A=this;var cH=function(cI,cJ){A.publish(cI,{defaultFn:cJ,queuable:false,emitFacade:true,bubbles:true});};},_dragTickAlignX:function(cH){var cQ=this;var cR=cH.target.get(aP);var cS=cQ._getColumnRefWidth();var cK=cR.get(cG);var cN=cQ.proxyEvt;var cO=cK.getData(aD);var cP=(cR.actXY[0]-cQ.bodyNode.getX()-cQ.colTimeNode.get(b4));var cI=Math.floor(cP/cS);var cM=cQ.colDaysNode.item(cI);var cL=cQ.getDateByColumn(cI);var A=aq.clone(cL);var cJ=aq.clone(cL);aq.copyHours(cJ,cN.get(aA));aq.copyHours(A,cN.get(b8));cN.set(aA,cJ);cN.set(b8,A);},_dragTickAlignY:function(cI){var cN=this;var cO=cI.target.get(aP);var cK=cO.get(cG);var cL=cN.proxyEvt;var cM=cK.getData(aD);var cH=aq.clone(cL.get(b8));var A=cN.calculateHoursByTop(bH(cO.get(cb).getComputedStyle(bq)));cN._setTickedHours(cH,A);var cJ=aq.clone(cH);cL.set(aA,aq.add(cJ,aq.MINUTES,cN._currentEvtDuration));cL.set(b8,cH);cL.syncNodeTitleUI();},_getXYDelta:function(cH){var A=this;var cJ=cH.currentTarget;
var cI=cJ.getXY(),cK=[cH.pageX,cH.pageY];return b5.Array.map(cI,function(cM,cL){return(cK[cL]-cM);});},_getTickY:function(){var A=this;return bJ(Math.ceil(A.get(aE)/2),10);},_getColumnRefWidth:function(){var A=this;var cH=A.colDaysNode.item(0);return bH(cH.getStyle(bz))-bH(cH.getStyle(cd))-bH(cH.getStyle(u));},_setupDragDrop:function(){var cI=this;var cJ=cI.get(aQ);if(!cI.proxyEvt){var cK=cI.get(r);cI.proxyEvt=new b5.SchedulerEvent({scheduler:cK});cI.proxyEvt.removeTarget(cK);cI.proxyEvt.get(cG).addClass(bQ);}if(!cI.delegate){cI.delegate=new b5.DD.Delegate(cI.get(E));}var cH=cI.delegate.dd;var cL=cI.proxyEvt;var cM=cI.get(aE)/2;var A=cI._getColumnRefWidth();cH.unplug(b5.Plugin.DDConstrained);cH.unplug(b5.Plugin.DDNodeScroll);cH.plug(b5.Plugin.DDConstrained,{bubbleTargets:cI,constrain:cI.bodyNode,tickX:A,tickY:cM});cH.plug(b5.Plugin.DDNodeScroll,{node:cI.bodyNode,scrollDelay:150});},_uiSetCurrentDate:function(cH){var A=this;A.syncColumnsUI();A.syncDaysHeaderUI();},_onClickDaysHeader:function(cJ){var A=this;var cI=A.get(r);if(cJ.target.test(k)){var cK=cI.getViewByName(cj);var cH=A.colHeaderDaysNode.indexOf(cJ.currentTarget)-1;if(cK){cI.set(bb,A.getDateByColumn(cH));cI.set(bG,cK);}}cJ.preventDefault();},_onEventDragEnd:function(A){var cN=this;var cK=cN.get(r);var cJ=cN.get(aQ);var cO=cN.delegate.dd;var cI=cO.get(cG);var cL=cN.proxyEvt;var cH=cL.get(cG);var cM=cI.getData(aD);cI.show();cH.hide();cJ.selectable();cM.copyDates(cL);cK.syncEventsUI();},_onEventDragStart:function(A){var cN=this;var cK=cN.get(aQ);var cO=cN.delegate.dd;var cJ=cO.get(cG);var cL=cN.proxyEvt;var cM=cJ.getData(aD);var cI=bH(cJ.getComputedStyle(aR));if(cI){cO.deltaXY[0]=(cI+bH(cO.deltaXY[0]));}if(cM){var cP=cM.get(cr);var cH=cL.get(cG);cO.set(cb,cH);cP.append(cH);cL.copyPropagateAttrValues(cM);cN.syncEventTopUI(cL);cN.syncEventHeightUI(cL);cH.show();cN._currentEvtDuration=cM.getMinutesDuration();}cJ.hide();cK.unselectable();},_onMouseDownTableCol:function(cJ){var A=this;var cI=A.get(r);var cK=cI.get(cF);if(cK&&!cI.get(bE)){cK.hideOverlay();if(cJ.target.test(bN+aB)){var cH=A.colDaysNode.indexOf(cJ.currentTarget);A.dragXY=A.startXY=A._getXYDelta(cJ);A.ddStartDate=A.getDateByColumn(cH);A.ddEndDate=aq.clone(A.ddStartDate);A._setTickedHours(A.ddStartDate,A.calculateHoursByTop(A.startXY[1]));A.ddMaxDate=aq.clone(A.ddStartDate);A.ddMaxDate.setHours(23,59,59);cK.set(b8,A.ddStartDate);cK.set(aA,A.limitDate(cK.get(aA),A.ddMaxDate));cJ.halt();}}},_onMouseMoveTableCol:function(cK){var A=this;var cJ=A.get(r);var cN=cJ.get(cF);var cL=A.ddStartDate;if(cL){A.dragXY=A._getXYDelta(cK);A._setTickedHours(A.ddEndDate,A.calculateHoursByTop(A.dragXY[1]));var cM=aq.getMinutesOffset(A.ddEndDate,cL);if((A.dragXY[1]-A.startXY[1])>0){cM=aK(cM,cN.get(bT));}var cH=A.limitDate(aq.add(cL,aq.MINUTES,cM),A.ddMaxDate);if(cM>0){cN.set(aA,cH);}else{var cI=cN.get(aA);cN.set(b8,cH);cN.set(aA,cI);}A.syncEventRecorderUI(cK.currentTarget);}},_onMouseUpTableCol:function(cI){var A=this;var cH=A.get(r);var cJ=cH.get(cF);if(cJ&&!cH.get(bE)){if(A.ddStartDate){A.syncEventRecorderUI(cI.currentTarget);cJ.showOverlay();}A.ddEndDate=null;A.ddStartDate=null;}},_setTickedHours:function(cH,cI){var A=this;cH.setHours(cI[0],bJ(cI[1],A._getTickY()),cI[2]);},_valueColDaysNode:function(){var A=this;var cI=A.get(U);var cH=[];while(cI--){cH.push(bd);}return b5.NodeList.create(cH.join(bF));},_valueColHeaderDaysNode:function(){var A=this;var cI=A.get(U);var cH=[];cH.push(at);while(cI--){cH.push(bg);}cH.push(w);return b5.NodeList.create(cH.join(bF));},_valueMarkercellsNode:function(){var A=this;var cH=[];for(var cI=0;cI<=23;cI++){cH.push(ae);}return b5.NodeList.create(cH.join(bF));},_valueTimesNode:function(){var A=this;var cJ=A.get(ak);var cI=[];for(var cH=0;cH<=23;cH++){cI.push(b5.substitute(i,{hour:cJ?aq.toIsoTimeString(cH):aq.toUsTimeString(cH,false,true)}));}return b5.NodeList.create(cI.join(bF));}}});b5.SchedulerDayView=cz;var am=b5.Component.create({NAME:b9,ATTRS:{bodyContent:{value:bF},days:{value:7},name:{value:cp}},EXTENDS:b5.SchedulerDayView,prototype:{adjustCurrentDate:function(){var A=this;var cJ=A.get(r);var cH=cJ.get(bb);var cI=cJ.get(ca);cJ.set(bb,aq.getFirstDayOfWeek(cH,cI));},getNextDate:function(){var A=this;var cI=A.get(r);var cH=cI.get(bb);var cJ=A._firstDayOfWeek(cH);return aq.add(cJ,aq.WEEK,1);},getPrevDate:function(){var A=this;var cI=A.get(r);var cH=cI.get(bb);var cJ=A._firstDayOfWeek(cH);return aq.subtract(cJ,aq.WEEK,1);},getToday:function(){var A=this;var cH=am.superclass.getToday.apply(this,arguments);return A._firstDayOfWeek(cH);},_firstDayOfWeek:function(cI){var A=this;var cJ=A.get(r);var cH=cJ.get(ca);return aq.getFirstDayOfWeek(cI,cH);}}});b5.SchedulerWeekView=am;var h=F(bL,bD,aO),a3=F(bL,bD,b3,ag),x=F(bL,bD,b3,cj),cv=F(bL,bD,b3,aT),bX=F(bL,bD,bp),ao=F(bL,bD,bp,aO),f=F(v),l=F(v,"arrowstop-1-l"),cs=F(v,"arrowstop-1-r"),bY=F(bL,bD,a),b=F(bL,bD,a,al),o=F(bL,bD,a,aH),bC=F(bL,bD,aT,by),aZ=F(bL,bD,aT,by,aH),bW=F(bL,bD,aT,by,ag),cc=F(bL,bD,aT,by,ag,aH),a0=F(bL,bD,aT,by,ag,aj),aV=F(bL,bD,aT,by,ag,g),S=F(bL,bD,aT,by,ag,g,al),af=F(bL,bD,aT,by,ag,g,aH),C=F(bL,bD,aT,by,ag,g,aN),cx=F(bL,bD,aT,by,ag,g,ab),bn=F(bL,bD,aT,by,a2),d=F(bL,bD,aT,by,a2,aR),bP=F(bL,bD,aT,by,a2,aY),p=F(bL,bD,aT,by,a2,b0),bc=F(bL,bD,aT,a8),cn=F(bL,bD,aT,a8,aH),cC=F(bL,aT,bs,b3),G='<table class="'+cv+'">'+"<tbody>"+'<tr class="'+a3+'"></tr>'+"</tbody>"+"</table>",N='<th class="'+x+'"><div>&nbsp;</div></th>',ck='<div class="'+h+'">'+'<div class="'+ao+'">'+'<div class="'+bX+'" style="top: 0; height: 16.6667%;"></div>'+'<div class="'+bX+'" style="top: 16.6667%; height: 16.6667%;"></div>'+'<div class="'+bX+'" style="top: 33.3333%; height: 16.6667%;"></div>'+'<div class="'+bX+'" style="top: 50%; height: 16.6667%;"></div>'+'<div class="'+bX+'" style="top: 66.6667%; height: 16.6667%;"></div>'+'<div class="'+bX+'" style="top: 83.3333%; height: 16.6667%;"></div>'+"</div>"+"</div>",bu='<table cellspacing="0" cellpadding="0" class="'+bc+'">'+"<tbody>"+"<tr>"+'<td class="'+[bY,o].join(V)+'">&nbsp;</td>'+'<td class="'+bY+'">&nbsp;</td>'+'<td class="'+bY+'">&nbsp;</td>'+'<td class="'+bY+'">&nbsp;</td>'+'<td class="'+bY+'">&nbsp;</td>'+'<td class="'+bY+'">&nbsp;</td>'+'<td class="'+bY+'">&nbsp;</td>'+"</tr>"+"</tbody>"+"</table>",bR='<table cellspacing="0" cellpadding="0" class="'+bC+'">'+"<tbody></tbody>"+"</table>",cg="<tr></tr>",a5='<td class="'+bW+'"><div></div></td>',Z='<span class="'+[f,l].join(V)+'"></span>',J='<span class="'+[f,cs].join(V)+'"></span>';
var az=b5.Component.create({NAME:cw,ATTRS:{bodyContent:{value:bF},name:{value:bD},headerDateFormat:{value:"%a"},navigationDateFormat:{value:"%b %Y"},scrollable:{value:false},monthContainerNode:{valueFn:function(){return b5.Node.create(ck);}},headerTableNode:{valueFn:function(){return b5.Node.create(G);}},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},tableGridNode:{valueFn:"_valueTableGridNode"}},HTML_PARSER:{tableGridNode:O(bN+bc,7),colHeaderDaysNode:O(bN+x,7),monthContainerNode:bN+h,headerTableNode:bN+cv},EXTENDS:b5.SchedulerView,prototype:{evtDateStack:null,evtDataTableStack:null,initializer:function(){var A=this;var cH=A.get(r);A.evtDateStack={};A.evtDataTableStack={};A.colHeaderDaysNode=A.get(b7);A.headerTableNode=A.get(cA);A.monthContainerNode=A.get(a7);A.tableGridNode=A.get(D);A.dayHeaderColNode=A.headerTableNode.one(bN+a3);A.monthRows=A.monthContainerNode.all(bN+bX);A.tableGridCols=A.tableGridNode.all(e);},renderUI:function(){var A=this;A.colHeaderDaysNode.appendTo(A.dayHeaderColNode);A.monthRows.each(function(cJ,cI){var cH=A.tableGridNode.item(cI);cJ.append(cH.toggleClass(cn,(cI==0)));});},buildEventsTable:function(cH,cM){var cS=this;var cP=5;var cJ=aq.clearTime(cS._findCurrentMonthEnd());var cR=aq.clearTime(cS._findCurrentMonthStart());var cO=String(cR.getTime()).concat(cH.getTime()).concat(cM.getTime());var cN=cS.evtDataTableStack[cO];if(!cN){cN=b5.Node.create(bR);var cQ=cN.one(bt);var cK=b5.Node.create(cg);cS.loopDates(cH,cM,function(cU,cT){var cV=b5.Node.create(a5);cV.addClass(aV).toggleClass(af,(cT==0)).toggleClass(S,aq.isToday(cU)).toggleClass(C,aq.isToday(aq.subtract(cU,aq.DAY,1))).toggleClass(cx,aq.isToday(aq.subtract(cU,aq.WEEK,1)));if(aq.before(cU,cR)||aq.after(cU,cJ)){cV.addClass(a0);}cK.append(cV.setContent(cU.getDate()));});cQ.append(cK);for(var A=0;A<cP;A++){var cL=0;var cI=b5.Node.create(cg);cS.loopDates(cH,cM,function(cY,cW){if(cL<=cW){var cX=cS.getIntersectEvents(cY),cU=cX[A];var cZ=b5.Node.create(a5);if(cU){var cT=cZ.one(X);var cV=cS._getEvtSplitInfo(cU,cH,cM);cZ.attr(W,cV.colspan);cT.addClass(bn).setContent(cS._getEvtLabel(cU));if(cV.left){cT.addClass(d).prepend(Z);}if(cV.right){cT.addClass(bP).append(J);}if(cU.get(co)){cT.addClass(p);}cL+=cV.colspan;}else{cL++;}cI.append(cZ);}});cQ.append(cI);}cS.evtDataTableStack[cO]=cN;}return cN;},flushViewCache:function(){var A=this;A.evtDateStack={};A.evtDataTableStack={};},getIntersectEvents:function(cH){var A=this;var cJ=A.get(r);var cI=String(cH.getTime());if(!A.evtDateStack[cI]){A.evtDateStack[cI]=cJ.getIntersectEvents(cH);}return A.evtDateStack[cI];},loopDates:function(A,cJ,cM,cN,cL){var cO=this;var cH=aq.clone(A);var cI=cJ.getTime();for(var cK=0;cH.getTime()<=cI;cK++){cM.apply(cO,[cH,cK]);cH=aq.add(cH,(cN||aq.DAY),(cL||1));}},plotEvents:function(){var cH=this;var cI=cH._findCurrentMonthStart();var A=aq.safeClearTime(cH._findFirstDayOfWeek(cI));cH.bodyNode.all(bN+bC).remove();cH.monthRows.each(function(cM,cK){var cJ=aq.add(A,aq.WEEK,cK);var cN=aq.add(cJ,aq.DAY,aL-1);var cL=cH.buildEventsTable(cJ,cN);if(cK==0){cL.addClass(aZ);}cM.append(cL);});},syncStdContent:function(){var A=this;A.setStdModContent(b1.BODY,A.monthContainerNode.getDOM());A.setStdModContent(b1.HEADER,A.headerTableNode.getDOM());},syncGridUI:function(){var cO=this;var cI=cO.getToday();var cH=cO.get(r);cO.tableGridCols.removeClass(b);if(aq.isSameMonth(cI,cH.get(bb))){var A=cH.get(ca);var cI=cO.getToday();var cK=cO._findCurrentMonthStart();var cM=cO._findFirstDayOfWeek(cI);var cJ=aq.getWeekNumber(cI,A)-aq.getWeekNumber(cK,A);var cN=(cI.getDate()-cM.getDate());var cL=cO.tableGridNode.item(cJ).all(e).item(cN);if(cL){cL.addClass(b);}}},adjustCurrentDate:function(){var A=this;var cH=A.get(r);cH.set(bb,A._findCurrentMonthStart());},getNextDate:function(){var A=this;var cI=A.get(r);var cH=cI.get(bb);return aq.add(cH,aq.MONTH,1);},getPrevDate:function(){var A=this;var cI=A.get(r);var cH=cI.get(bb);return aq.subtract(cH,aq.MONTH,1);},syncDaysHeaderUI:function(){var cI=this;var cL=cI.get(r);var cJ=cL.get(bb);var cH=cI.get(a9);var A=cI.get(ay);var cK=cI._findFirstDayOfWeek(cJ);cI.colHeaderDaysNode.all(X).each(function(cO,cN){var cM=aq.add(cK,aq.DAY,cN);var cP=b5.DataType.Date.format(cM,{format:cH,locale:A});cO.html(cP);});},_findCurrentMonthEnd:function(){var A=this;var cI=A.get(r);var cH=cI.get(bb);return aq.findMonthEnd(cH);},_findCurrentMonthStart:function(){var A=this;var cI=A.get(r);var cH=cI.get(bb);return aq.findMonthStart(cH);},_findFirstDayOfWeek:function(cI){var A=this;var cJ=A.get(r);var cH=cJ.get(ca);return aq.getFirstDayOfWeek(cI,cH);},_getEvtLabel:function(cI){var cH=this;var cJ=cI.get(aA);var A=cI.get(b8);return[A.getHours(),bI,cJ.getHours(),V,cI.get(aM)].join(bF);},_getEvtSplitInfo:function(cN,A,cL){var cO=this;var cH=cN.getClearStartDate();var cM=cN.getClearEndDate();var cK=cN.getDaysDuration();var cJ={};var cI=1;if(aq.after(cH,A)){cI=Math.min(cK,Math.abs(aq.getDayOffset(cL,cH))+1);if(cI>1){cJ.right=true;}}else{cI=Math.abs(aq.getDayOffset(cM,A)+1);if(cI>1){cJ.left=true;}}cJ.colspan=Math.min(cI,aL);if(cI>=aL){cJ.right=true;cJ.left=true;}return cJ;},_uiSetCurrentDate:function(cH){var A=this;A.syncDaysHeaderUI();A.syncGridUI();},_valueColHeaderDaysNode:function(){var A=this;return A._valueNodeList(aL,N);},_valueTableGridNode:function(){var A=this;return A._valueNodeList(aL,bu);},_valueNodeList:function(cJ,cI){var A=this;var cH=[];while(cJ--){cH.push(cI);}return b5.NodeList.create(cH.join(bF));}}});b5.SchedulerMonthView=az;},"1.0.1",{requires:["aui-scheduler-event","aui-calendar","aui-button-item","substitute","dd-drag","dd-delegate","dd-drop","dd-constrain"],skinnable:true});AUI.add("aui-scheduler-event",function(aF){var am=aF.Lang,bh=am.isString,h=am.isDate,a5=am.isFunction,P=am.isObject,a8=am.isBoolean,aa=am.isNumber,aW=aF.ColorUtil,n=aF.DataType.DateMath,a2=aF.cached(function(A){return A.substring(0,1).toUpperCase()+A.substring(1);}),bd="-",z="&ndash;",av=".",u="",v=" ",r="_",aJ="_propagateSet",U="activeView",aD="borderStyle",bp="borderWidth",Q="Change",a1="color",aS="colorBrightnessFactor",bb="colorSaturationFactor",aB="content",ag="contentNode",B="disabled",aZ="duration",aM="endDate",bi="events",aq="hidden",ap="icon",Y="icons",a0="id",aU="isoTime",bo="locale",s="node",k="overlay",aH="parentEvent",bs="recorder",aK="repeat",bg="repeated",a6="repeater",T="repeatedEvents",af="scheduler",at="scheduler-event",au="scheduler-event-recorder",bk="startDate",a4="template",aR="title",g="titleDateFormat",N="titleNode",an="visible",f="%H:%M",a3="%I:%M",L=aF.ClassNameManager.getClassName,o=L(ap),w=L(at),aN=L(at,aB),G=L(at,aq),bf=L(at,B),ao=L(at,bs),ax=L(at,bg),al=L(at,a6),I=L(at,aR),bn=L(at,Y);
CSS_SCHEDULER_EVENT_ICON_DISABLED=L(at,ap,B),CSS_SCHEDULER_EVENT_ICON_REPEATED=L(at,ap,bg),CSS_SCHEDULER_EVENT_ICON_REPEATER=L(at,ap,a6);var V=aF.Component.create({NAME:at,ATTRS:{borderStyle:{value:"solid",validator:bh},borderWidth:{value:"1px",validator:bh},colorBrightnessFactor:{value:0.75,validator:aa},colorSaturationFactor:{value:1.5,validator:aa},content:{value:"(no title)",validator:bh},color:{lazyAdd:false,setter:"_setColor",value:"#D96666",validator:bh},titleDateFormat:{getter:"_getTitleDateFormat",validator:bh},endDate:{valueFn:function(){var A=n.clone(this.get(bk));A.setHours(A.getHours()+1);return A;},validator:h},columnNode:{setter:aF.one},disabled:{value:false,validator:a8},node:{valueFn:function(){return aF.Node.create(this.EVENT_NODE_TEMPLATE).setData(at,this);},setter:aF.one},parentEvent:{},repeat:{setter:"_setRepeat"},scheduler:{lazyAdd:false,setter:"_setScheduler"},startDate:{valueFn:function(){return new Date();},validator:h},visible:{value:true,validator:a8}},EXTENDS:aF.Base,PROPAGATE_ATTRS:[bk,aM,aB,a1,aS,bb,aD,bp,g,an,B],prototype:{EVENT_NODE_TEMPLATE:'<div class="'+w+'">'+'<div class="'+I+'"></div>'+'<div class="'+aN+'"></div>'+'<div class="'+bn+'">'+'<span class="'+[o,CSS_SCHEDULER_EVENT_ICON_REPEATED].join(v)+'"></span>'+'<span class="'+[o,CSS_SCHEDULER_EVENT_ICON_REPEATER].join(v)+'"></span>'+'<span class="'+[o,CSS_SCHEDULER_EVENT_ICON_DISABLED].join(v)+'"></span>'+"</div>"+"</div>",eventStack:null,initializer:function(){var A=this;var bu=A.get(s);A.eventStack={};A.nodeStack={};aF.Array.each(aF.SchedulerEvent.PROPAGATE_ATTRS,function(bv){A.after(bv+Q,A._propagateAttrChange);});A._bindUIAttrs();A.contentNode=bu.one(av+aN);A.titleNode=bu.one(av+I);A.syncNodeUI(true);},destroy:function(){var A=this;A.eachRepeatedEvent(function(bu,bv){bu.destroy();});A.eventStack={};A.get(s).remove(true);},copyDates:function(bu){var A=this;A.set(aM,n.clone(bu.get(aM)));A.set(bk,n.clone(bu.get(bk)));},copyPropagateAttrValues:function(bu,bv){var A=this;A.copyDates(bu);aF.Array.each(aF.SchedulerEvent.PROPAGATE_ATTRS,function(bw){if(!(bw in (bv||{}))){var bx=bu.get(bw);if(!P(bx)){A.set(bw,bx);}}});},getBorderColor:function(){var A=this;return A.borderColorRGB.hex;},getDaysDuration:function(){var A=this;return n.getDayOffset(A.get(aM),A.get(bk));},getHoursDuration:function(){var A=this;return n.getHoursOffset(A.get(aM),A.get(bk));},getMinutesDuration:function(){var A=this;return n.getMinutesOffset(A.get(aM),A.get(bk));},getSecondsDuration:function(){var A=this;return n.getSecondsOffset(A.get(aM),A.get(bk));},sameEndDate:function(bu){var A=this;return n.compare(A.get(aM),bu.get(aM));},sameStartDate:function(bu){var A=this;return n.compare(A.get(bk),bu.get(bk));},isAfter:function(bw){var bv=this;var bu=bv.get(bk);var A=bw.get(bk);return n.after(bu,A);},isBefore:function(bw){var bv=this;var bu=bv.get(bk);var A=bw.get(bk);return n.before(bu,A);},repeatByDate:function(bv){var A=this;var bw=A.uidByDate(bv);if(!A.eventStack[bw]){var bu=n.clone(bv);var bx=n.clone(bv);n.copyHours(bu,A.get(bk));n.copyHours(bx,A.get(aM));var by=new aF.SchedulerEvent({endDate:bx,parentEvent:A,scheduler:A.get(af),startDate:bu});by.copyPropagateAttrValues(A);A.eventStack[bw]=by;}return A.eventStack[bw];},intersects:function(bw){var bv=this;var bx=bv.get(aM);var bu=bv.get(bk);var A=bw.get(bk);return(bv.sameStartDate(bw)||n.between(A,bu,bx));},intersectHours:function(bv){var bu=this;var bx=bu.get(aM);var A=bu.get(bk);var bw=n.clone(A);n.copyHours(bw,bv.get(bk));return(n.compare(A,bw)||n.between(bw,A,bx));},isDayOverlapEvent:function(){var A=this;return n.isDayOverlap(A.get(bk),A.get(aM));},isRepeatableDate:function(bu){var A=this;var bv=A.get(aK);return(bv&&bv.validate(A,bu));},getClearEndDate:function(){var A=this;return n.safeClearTime(A.get(aM));},getClearStartDate:function(){var A=this;return n.safeClearTime(A.get(bk));},uidByDate:function(bu){var A=this;bu=h(bu)?n.safeClearTime(bu):A.getClearStartDate();return[at,bu.getTime()].join(r);},setContent:function(bv,bu){var A=this;A._setContent(ag,bv,bu);},setTitle:function(bv,bu){var A=this;A._setContent(N,bv,bu);},syncNodeUI:function(bu){var A=this;A._syncUIAttrs();A.syncNodeColorUI(bu);A.syncNodeTitleUI(bu);A.syncNodeContentUI(bu);},syncNodeColorUI:function(bu){var A=this;var bv=A.get(s);var bw=A.getBorderColor();if(bv){bv.setStyles({borderWidth:A.get(bp),borderColor:bw,backgroundColor:A.get(a1),borderStyle:A.get(aD)});}if(A.titleNode){A.titleNode.setStyles({backgroundColor:bw});}if(bu){A.eachRepeatedEvent(function(bx,by){bx.syncNodeColorUI();});}},syncNodeContentUI:function(bu){var A=this;A.setContent(A.get(aB),bu);},syncNodeTitleUI:function(bu){var A=this;var bv=A._formatDate(A.get(bk));var bw=A._formatDate(A.get(aM));A.setTitle([bv,bw].join(v+z+v),bu);},eachRepeatedEvent:function(bu){var A=this;aF.each(A.eventStack,bu,A);},unlink:function(){var A=this;if(A.get(aH)){A.set(aH,null);}else{A.eachRepeatedEvent(function(bu,bv){bu.unlink();});}A.eventStack={};A.syncNodeUI();},_afterDisabledChange:function(bu){var A=this;A._uiSetDisabled(bu.newVal);},_afterVisibleChange:function(bu){var A=this;A._uiSetVisible(bu.newVal);},_afterRepeatChange:function(bu){var A=this;A._uiSetRepeat(bu.newVal);},_afterParentEventChange:function(bu){var A=this;A._uiSetParentEvent(bu.newVal);},_bindUIAttrs:function(){var A=this;A.after("disabledChange",A._afterDisabledChange);A.after("visibleChange",A._afterVisibleChange);A.after("parentEventChange",A._afterParentEventChange);A.after("repeatChange",A._afterRepeatChange);A._syncUIAttrs();},_propagateAttrChange:function(bw){var A=this;var bv=bw.attrName;var bu=bw.newVal;A.eachRepeatedEvent(function(bx,by){var bz=bx[aJ+a2(bv)];if(bz){bz.apply(A,[bx,bv,bu]);}else{bx.set(bv,bw.newVal);}bx.syncNodeUI();});A.syncNodeUI();},_propagateSetEndDate:function(A,bu,bw){var bv=n.clone(A.get(aM));n.copyHours(bv,bw);A.set(aM,bv);},_propagateSetStartDate:function(bu,bv,bw){var A=n.clone(bu.get(bk));n.copyHours(A,bw);bu.set(bk,A);},_setColor:function(bu){var A=this;A.hsbColor=aW.rgb2hsb(aW.getRGB(bu));
A.borderColor=aF.clone(A.hsbColor);A.borderColor.b*=A.get(aS);A.borderColor.s*=A.get(bb);A.borderColorRGB=aW.hsb2rgb(A.borderColor);return bu;},_setContent:function(bv,bx,bu){var A=this;var bw=A[bv];if(bw){bw.setContent(bx);}if(bu){A.eachRepeatedEvent(function(by,bz){by[bv].setContent(bx);});}},_setRepeat:function(bu){var A=this;if(bh(bu)){bu=aF.SchedulerEventRepeat[bu];}return P(bu)?bu:null;},_setScheduler:function(bv){var A=this;var bu=A.get(af);if(bu){A.removeTarget(bu);}A.addTarget(bv);return bv;},_syncUIAttrs:function(){var A=this;A._uiSetDisabled(A.get(B));A._uiSetVisible(A.get(an));A._uiSetParentEvent(A.get(aH));A._uiSetRepeat(A.get(aK));},_formatDate:function(bv,bw){var bu=this;var A=bu.get(bo);bw=bw||bu.get(g);return aF.DataType.Date.format(bv,{format:bw,locale:A});},_getTitleDateFormat:function(bv){var A=this;if(!bh(bv)){var bu=A.get(af);bv=(bu&&bu.get(U).get(aU))?f:a3;}return bv;},_uiSetDisabled:function(bu){var A=this;A.get(s).toggleClass(bf,!!bu);},_uiSetParentEvent:function(bu){var A=this;A.get(s).toggleClass(ax,!!bu);},_uiSetRepeat:function(bu){var A=this;A.get(s).toggleClass(al,!!bu);},_uiSetVisible:function(bu){var A=this;A.get(s).toggleClass(G,!bu);}}});aF.SchedulerEvent=V;aF.SchedulerEventRepeat={daily:{description:"Every day",validate:function(A,bu){return true;},value:"daily"},monthly:{description:"Every month",validate:function(bu,bv){var bw=bu.get(aM);var A=bu.get(bk);return(A.getDate()===bv.getDate());},value:"monthly"},monWedFri:{description:"Every Monday, Wednesday and Friday",validate:function(A,bu){return n.isMonWedOrFri(bu);},value:"monWedFri"},tuesThurs:{description:"Every Tuesday and Thursday",validate:function(A,bu){return n.isTueOrThu(bu);},value:"tuesThurs"},weekDays:{description:"Every week days",validate:function(A,bu){return n.isWeekDay(bu);},value:"weekDays"},weekly:{description:"Every week",validate:function(bu,bv){var bw=bu.get(aM);var A=bu.get(bk);return(A.getDay()===bv.getDay());},value:"weekly"},yearly:{description:"Every year",validate:function(bu,bv){var bw=bu.get(aM);var A=bu.get(bk);return((A.getMonth()===bv.getMonth())&&(A.getDay()===bv.getDay()));},value:"yearly"}};var U="activeView",bm="bc",bl="bd",aw="bodyContent",t="boundingBox",aG="button",e="column",aB="content",aC="dateFormat",az="dblclick",aY="desc",ay="disk",br="event",a7="field",aI="fieldset",aA="form",ah="hint",ak="input",aU="isoTime",aL="label",x="layout",aQ="menu",J="overlayContextPanel",p="pencil",aK="repeat",q="row",af="scheduler",Z="select",S="strings",a="tc",M="text",X="when",j="trigger",ai="auiSchedulerEventRecorderWhen",bc="auiSchedulerEventRecorderDesc",aX="auiSchedulerEventRecorderSelect",H="auiSchedulerEventRecorderButtonRow",ae="cancel",E="edit",aE="save",bd="-",K="#",bt=L(at,bs,k),ba=L(at,bs,aA),y=L(aA),l=L(x,aB),be=L(x,aI),ar=L(x,aI,bl),ad=L(x,aI,aB),F=L(x,"w100"),m=L(e),aO=L(e,aB),b=L(a7),C=L(a7,aQ),aP=L(a7,Z),bj=L(a7,aB),d=L(a7,aL),aV=L(a7,M),i=L(aG,q),a9=L(a7,ak),aj=L(a7,ak,Z),D=L(a7,ak,M),aT=L(at,bs,aL,X),c=L(at,bs,aY),R=L(at,bs,a7,ah),ac=L(at,bs,aK),ab=L(at,bs,aG,q),O="<option></option>",bq='<form id="auiSchedulerEventRecorderForm" class="'+[ba,l,y].join(v)+'">'+'<div class="'+[be,F,m].join(v)+'">'+'<div class="'+[ad,aO].join(v)+'aui-fieldset-content aui-column-content">'+'<div class="'+ar+'">'+'<span class="'+[b,aV].join(v)+'">'+'<span class="'+bj+'">'+'<label class="'+d+'">{when}:</label>'+'<span id="auiSchedulerEventRecorderWhen" class="'+aT+'"></span>'+"</span>"+"</span>"+'<span class="'+[b,aV].join(v)+'">'+'<span class="'+bj+'">'+'<label class="'+d+'" for="auiSchedulerEventRecorderDesc">{description}</label>'+'<input id="auiSchedulerEventRecorderDesc" class="'+[a9,D,c].join(v)+'" size="30" type="text" />'+'<div class="'+R+'">'+"<span>{description-hint}</span>"+"</div>"+"</span>"+"</span>"+'<span class="'+[b,C,aP].join(v)+'">'+'<label class="'+d+'" for="auiSchedulerEventRecorderSelect">{repeat}:</label>'+'<select id="auiSchedulerEventRecorderSelect" class="'+[a9,aj,ac].join(v)+'">'+'<option selected="selected" value="">{no-repeat}</option>'+"</select>"+"</span>"+'<div id="auiSchedulerEventRecorderButtonRow" class="'+[b,i,ab].join(v)+'"></div>'+"</div>"+"</div>"+"</div>"+"</form>";var W=aF.Component.create({NAME:au,ATTRS:{content:{value:u},duration:{value:60},dateFormat:{value:"%a, %B %d,",validator:bh},event:{},strings:{value:{},setter:function(A){return aF.merge({save:"Save",cancel:"Cancel",description:"Description",edit:"Edit",repeat:"Repeat",when:"When","description-hint":"e.g., Dinner at Brian's","no-repeat":"No repeat"},A||{});},validator:P},overlayContextPanel:{value:{},setter:function(bu){var A=this;var bv=aF.Node.create(aF.substitute(bq,A.get(S)));return aF.merge({align:{points:[bm,a]},anim:false,bodyContent:bv,hideOn:az,trigger:A.get(s),visible:false,zIndex:9999},bu||{});}}},EXTENDS:aF.SchedulerEvent,prototype:{initializer:function(){var A=this;A._createEvents();A.after("schedulerChange",A._afterSchedulerChange);A.on("startDateChange",A._onStartDateChange);A.get(s).addClass(ao);},showOverlay:function(){var A=this;if(!A.overlay){A._initOverlay();}A.overlay.render().show();},getEventCopy:function(bu){var A=this;var bw=A.overlayDescNode.val();var bv=A.get(br);if(!bv){bv=new aF.SchedulerEvent({endDate:A.get(aM),scheduler:A.get(af),startDate:A.get(bk)});bv.copyPropagateAttrValues(A,{content:true});}bv.set(aK,A.overlaySelectNode.val());if(bw){bv.set(aB,bw);}return bv;},hideOverlay:function(){var A=this;if(A.overlay){A.overlay.hide();}},loadFormValues:function(){var A=this;var bw=u;var bv=u;var bu=A.get(br);if(bu){var bx=bu.get(aK);if(bx){bw=bx.value;}bv=bu.get(aB);}A.overlaySelectNode.val(bw);A.overlayWhenNode.setContent(A._getWhenFormattedDt());setTimeout(function(){A.overlayDescNode.val(bv).selectText();},0);},_afterSchedulerChange:function(bw){var A=this;var bv=bw.newVal;var bu=bv.get(t);bu.delegate("click",aF.bind(A._onClickSchedulerEvent,A),av+w);},_createEvents:function(){var A=this;var bu=function(bv,bw){A.publish(bv,{defaultFn:bw,queuable:false,emitFacade:true,bubbles:true});
};bu(aE,this._defSaveEventFn);bu(E,this._defEditEventFn);bu(ae,this._defCancelEventFn);},_initOverlay:function(){var bu=this;var A=bu.get(S);bu.overlay=new aF.OverlayContextPanel(bu.get(J));var bw=bu.overlay;var bv=bw.get(t);var bx=bw.get(aw);bu.overlayButtonRowNode=bx.one(K+H);bu.overlayDescNode=bx.one(K+bc);bu.overlaySelectNode=bx.one(K+aX);bu.overlayWhenNode=bx.one(K+ai);bu.overlaySaveBtn=new aF.ButtonItem({label:A.save,icon:ay,render:bu.overlayButtonRowNode,handler:{fn:bu._handleSaveEvent,context:bu}});bu.overlayEditBtn=new aF.ButtonItem({label:A.edit,icon:p,render:bu.overlayButtonRowNode,handler:{fn:bu._handleEditEvent,context:bu}});bu.overlayCancelBtn=new aF.ButtonItem({label:A.cancel,render:bu.overlayButtonRowNode,handler:{fn:bu._handleCancelEvent,context:bu}});aF.each(aF.SchedulerEventRepeat,function(bz,by){bu.overlaySelectNode.append(aF.Node.create(O).val(bz.value||by).setContent(bz.description));});bw.on("hide",aF.bind(bu._onOverlayHide,bu));bw.on("show",aF.bind(bu._onOverlayShow,bu));bx.on("submit",aF.bind(bu._onSubmitForm,bu));bv.addClass(bt);},_defCancelEventFn:function(bu){var A=this;A.hideOverlay();},_defEditEventFn:function(bv){var A=this;var bu=A.get(af);A.hideOverlay();bu.syncEventsUI();},_defSaveEventFn:function(bv){var A=this;var bu=A.get(af);bu.addEvent(bv.newSchedulerEvent);A.hideOverlay();bu.syncEventsUI();},_getWhenFormattedDt:function(){var bv=this;var bu=bv.get(aC);var bx=(bv.get(br)||bv);var bz=bx.get(aM);var by=bx.get(af);var A=bx.get(bk);var bw=(by.get(U).get(aU)?n.toIsoTimeString:n.toUsTimeString);return[bx._formatDate(A,bu),bw(A),bd,bw(bz)].join(v);},_handleEditEvent:function(bu){var A=this;A.fire(E,{newSchedulerEvent:A.getEventCopy()});bu.preventDefault();},_handleSaveEvent:function(bu){var A=this;A.fire(aE,{newSchedulerEvent:A.getEventCopy()});bu.preventDefault();},_handleCancelEvent:function(bu){var A=this;A.fire(ae);bu.preventDefault();},_onClickSchedulerEvent:function(bv){var A=this;var bu=bv.currentTarget.getData(at);if(bu){if(!A.overlay){A._initOverlay();}A.set(br,bu);A.overlay.set(j,bu.get(s));A.get(s).remove();A.showOverlay();}},_onOverlayHide:function(bv){var A=this;var bu=A.get(s);if(A.overlay){A.set(br,null);A.overlay.set(j,bu);}bu.remove();},_onOverlayShow:function(bv){var bu=this;var bw=bu.overlayEditBtn;var A=bu.overlaySaveBtn;if(bu.get(br)){bw.show();A.hide();}else{bw.hide();A.show();}bu.loadFormValues();},_onStartDateChange:function(bu){var A=this;var bv=A.get(aZ);A.set(aM,n.add(bu.newVal,n.MINUTES,bv));},_onSubmitForm:function(bu){var A=this;if(A.get(br)){A._handleEditEvent(bu);}else{A._handleSaveEvent(bu);}}}});aF.SchedulerEventRecorder=W;},"1.0.1",{requires:["aui-base","aui-color-util","aui-datatype","aui-overlay-context-panel","substitute"],skinnable:true});AUI.add("aui-scheduler-calendar",function(d){var i=d.Lang,j=i.isArray,c=i.isBoolean,b=i.isString,g=function(m){return(m instanceof d.SchedulerEvent);},e="scheduler-calendar",a="color",l="events",h="pallete",k="visible";var f=d.Component.create({NAME:e,ATTRS:{color:{valueFn:function(){var n=this;var o=n.get(h);var m=Math.ceil(Math.random()*o.length)-1;return o[m];},validator:b},name:{value:"(no name)",validator:b},pallete:{value:["#d96666","#e67399","#b373b3","#8c66d9","#668cb3","#668cd9","#59bfb3","#65ad89","#4cb052","#8cbf40","#bfbf4d","#e0c240","#f2a640","#e6804d","#be9494","#a992a9","#8997a5","#94a2be","#85aaa5","#a7a77d","#c4a883","#c7561e","#b5515d","#c244ab","#603f99","#536ca6","#3640ad","#3c995b","#5ca632","#7ec225","#a7b828","#cf9911","#d47f1e","#b56414","#914d14","#ab2671","#9643a5","#4585a3","#737373","#41a587","#d1bc36","#ad2d2d"],validator:j},visible:{value:true,validator:c}},EXTENDS:d.Base,AUGMENTS:d.SchedulerEventSupport,prototype:{initializer:function(){var m=this;m.after("eventsChange",m._afterEventsChange);m.on("visibleChange",m._onVisibleChange);m._uiSetVisible(m.get(k));m._uiSetEvents(m.get(l));},syncEventsColor:function(n){var m=this;d.Array.each(n||m.get(l),function(o,p){o.set(a,m.get(a));});},_afterEventsChange:function(n){var m=this;m._uiSetEvents(n.newVal);},_onVisibleChange:function(n){var m=this;m._uiSetVisible(n.newVal);},_uiSetEvents:function(n){var m=this;m.syncEventsColor(n);},_uiSetVisible:function(n){var m=this;m.eachEvent(function(o,p){o.set(k,n);});}}});d.SchedulerCalendar=f;},"1.0.1",{requires:["aui-scheduler-event"],skinnable:true});AUI.add("aui-scheduler",function(a){},"1.0.1",{use:["aui-scheduler-base","aui-scheduler-view","aui-scheduler-event","aui-scheduler-calendar"],skinnable:true});