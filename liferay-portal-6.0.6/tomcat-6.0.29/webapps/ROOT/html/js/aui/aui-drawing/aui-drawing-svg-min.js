AUI.add("aui-drawing-svg",function(U){var I=U.Lang,O=I.isArray,B=I.isFunction,N=I.isObject,Q=I.isString,F=I.isUndefined,f=U.config,E=f.doc,c=U.ColorUtil,R=U.Drawing,W=R.Element,h,J=R.Util,S=R.prototype,H=W.prototype,P=Math,a=P.max,K=P.pow,T=R.MAP_ATTRS_AVAILABLE,X=R.MAP_TYPES_IMAGE_TEXT,b=R.MAP_TYPES_CIRCLE_ELLIPSE,e=R.REGEX_ISURL,M=R.REGEX_RADIAL_GRADIENT,L=R.REGEX_SEPARATOR,C=R.REGEX_SEPARATOR_GRADIENT,Z="Created with AlloyUI",V=R.STR_EMPTY,G=R.STR_FILL,D=R.STR_SPACE,g=1.2,Y=String.prototype.toLowerCase,d=String.prototype.toUpperCase;S.svgns="http://www.w3.org/2000/svg";S.xlink="http://www.w3.org/1999/xlink";J.CREATE_ELEMENT=function(A){var i=E.createElementNS(S.svgns,A);i.style.webkitTapHighlightColor="rgba(0,0,0,0)";return i;};J.SET_ATTRS=function(j,A){for(var i in A){if(A.hasOwnProperty(i)){j.setAttribute(i,String(A[i]));}}return j;};J.TUNE_TEXT=function(j,m){if(j.type!="text"||!(m.hasOwnProperty("text")||m.hasOwnProperty("font")||m.hasOwnProperty("font-size")||m.hasOwnProperty("x")||m.hasOwnProperty("y"))){return;}var l;var q=j.attrs;var k=j.node;var s=10;if(k.firstChild){s=parseInt(E.defaultView.getComputedStyle(k.firstChild,V).getPropertyValue("font-size"),10);}if(m.hasOwnProperty("text")){q.text=m.text;while(k.firstChild){k.removeChild(k.firstChild);}l=String(m.text).split("\n");for(var n=0,A=l.length;n<A;n++){if(l[n]){var p=J.CREATE_ELEMENT("tspan");if(n){J.SET_ATTRS(p,{dy:s*g,x:q.x});}p.appendChild(E.createTextNode(l[n]));k.appendChild(p);}}}else{l=k.getElementsByTagName("tspan");for(n=0,A=l.length;n<A;n++){if(n){J.SET_ATTRS(l[n],{dy:s*g,x:q.x});}}}J.SET_ATTRS(k,{y:q.y});var o=j.getRegion();var r=q.y-(o.y+o.height/2);if(r&&isFinite(r)){J.SET_ATTRS(k,{y:q.y+r});}};J.UPDATE_POSITION=function(A){var i=A.getRegion();J.SET_ATTRS(A.pattern,{patternTransform:U.substitute("translate({0},{1})",[i.x,i.y])});};h=R.Impl={addGradientFill:function(s,A,v){var o="linear";var n=0.5;var m=0.5;var k=s.style;var l;A=String(A).replace(M,function(AB,i,AC){o="radial";if(i&&AC){n=parseFloat(i);m=parseFloat(AC);var AA=((m>0.5)*2-1);K(n-0.5,2)+K(m-0.5,2)>0.25&&(m=P.sqrt(0.25-K(n-0.5,2))*AA+0.5)&&m!=0.5&&(m=m.toFixed(5)-0.00001*AA);}return V;});A=A.split(C);if(o=="linear"){var z=A.shift();z=-parseFloat(z);if(isNaN(z)){return null;}l=[0,0,P.cos(z*P.PI/180),P.sin(z*P.PI/180)];var x=1/(a(P.abs(l[2]),P.abs(l[3]))||1);l[2]*=x;l[3]*=x;if(l[2]<0){l[0]=-l[2];l[2]=0;}if(l[3]<0){l[1]=-l[3];l[3]=0;}}var r=J.parseDots(A);if(!r){return null;}var u=s.getAttribute(G);u=u.match(/^url\(#(.*)\)$/);u&&v.defs.removeChild(E.getElementById(u[1]));var j=J.CREATE_ELEMENT(o+"Gradient");j.id=U.guid();var t;if(o=="radial"){t={fx:n,fy:m};}else{t={x1:l[0],y1:l[1],x2:l[2],y2:l[3]};}J.SET_ATTRS(j,t);v.defs.appendChild(j);for(var y=0,p=r.length;y<p;y++){var w=J.CREATE_ELEMENT("stop");var q=r[y].offset;if(!q){if(!y){q="0%";}else{q="100%";}}J.SET_ATTRS(w,{offset:q,"stop-color":r[y].color||"#fff"});j.appendChild(w);}J.SET_ATTRS(s,{fill:"url(#"+j.id+")",opacity:1,"fill-opacity":1});k.fill=V;k.opacity=1;k.fillOpacity=1;return 1;},clear:function(){var A=this;var i=A.canvas;while(i.firstChild){i.removeChild(i.firstChild);}A.bottom=A.top=null;A.desc=J.CREATE_ELEMENT("desc");A.desc.appendChild(E.createTextNode(Z));i.appendChild(A.desc);A.defs=J.CREATE_ELEMENT("defs");i.appendChild(A.defs);},createCanvas:function(){var j=this;var k=j.get("contentBox");var i=j.get("x");var n=j.get("y");var m=j.get("width");var A=j.get("height");var l=J.CREATE_ELEMENT("svg");J.SET_ATTRS(l,{xmlns:"http://www.w3.org/2000/svg",version:1.1,width:m,height:A});k.prepend(l);j.canvas=l;j.clear();},createCircle:function(i,m,k){var A=this;var j=J.CREATE_ELEMENT("circle");A.canvas.appendChild(j);var l=new W(j,A);l.attrs={cx:i,cy:m,r:k,fill:"none",stroke:"#000"};l.type="circle";J.SET_ATTRS(j,l.attrs);return l;},createEllipse:function(i,n,m,l){var A=this;var j=J.CREATE_ELEMENT("ellipse");A.canvas.appendChild(j);var k=new W(j,A);k.attrs={cx:i,cy:n,rx:m,ry:l,fill:"none",stroke:"#000"};k.type="ellipse";J.SET_ATTRS(j,k.attrs);return k;},createImage:function(n,i,o,j,l){var A=this;var k=J.CREATE_ELEMENT("image");J.SET_ATTRS(k,{x:i,y:o,width:j,height:l,preserveAspectRatio:"none"});k.setAttributeNS(A.xlink,"href",n);A.canvas.appendChild(k);var m=new W(k,A);m.attrs={x:i,y:o,width:j,height:l,src:n};m.type="image";return m;},createPath:function(i){var A=this;var j=J.CREATE_ELEMENT("path");A.canvas.appendChild(j);var k=new W(j,A);k.type="path";h.setFillAndStroke(k,{fill:"none",stroke:"#000",path:i});return k;},createRectangle:function(i,o,j,l,n){var A=this;var k=J.CREATE_ELEMENT("rect");A.canvas.appendChild(k);var m=new W(k,A);m.attrs={x:i,y:o,width:j,height:l,r:n,rx:n,ry:n,fill:"none",stroke:"#000"};m.type="rect";J.SET_ATTRS(k,m.attrs);return m;},createText:function(i,m,l){var A=this;var k=J.CREATE_ELEMENT("text");J.SET_ATTRS(k,{x:i,y:m,"text-anchor":"middle"});A.canvas.appendChild(k);var j=new W(k,A);j.attrs={x:i,y:m,"text-anchor":"middle",text:l,font:T.font,stroke:"none",fill:"#000"};j.type="text";h.setFillAndStroke(j,j.attrs);return j;},setFillAndStroke:function(s,AE){var w={"":[0],"none":[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]};var y=s.node;var u=s.attrs;var q=s.rotate();var m=function(AL,AK){AK=w[Y.call(AK)];if(AK){var AI=AL.attrs["stroke-width"]||"1";var AG={round:AI,square:AI,butt:0}[AL.attrs["stroke-linecap"]||AE["stroke-linecap"]]||0;var AJ=[];var AH=AK.length;while(AH--){AJ[AH]=AK[AH]*AI+((AH%2)?1:-1)*AG;}J.SET_ATTRS(y,{"stroke-dasharray":AJ.join(",")});}};if(AE.hasOwnProperty("rotation")){q=AE.rotation;}var p=String(q).split(L);if(!(p.length-1)){p=null;}else{p[1]=+p[1];p[2]=+p[2];}parseFloat(q)&&s.rotate(0,true);for(var x in AE){if(AE.hasOwnProperty(x)){if(!T.hasOwnProperty(x)){continue;}var v=AE[x];u[x]=v;switch(x){case"blur":s.blur(v);break;case"rotation":s.rotate(v,true);break;case"href":case"title":case"target":var AB=y.parentNode;if(Y.call(AB.tagName)!="a"){var k=J.CREATE_ELEMENT("a");
AB.insertBefore(k,y);k.appendChild(y);AB=k;}AB.setAttributeNS(s.paper.xlink,x,v);break;case"cursor":y.style.cursor=v;break;case"clip-rect":var i=String(v).split(L);if(i.length==4){s.clip&&s.clip.parentNode.parentNode.removeChild(s.clip.parentNode);var j=J.CREATE_ELEMENT("clipPath");var z=J.CREATE_ELEMENT("rect");j.id=U.guid();J.SET_ATTRS(z,{x:i[0],y:i[1],width:i[2],height:i[3]});j.appendChild(z);s.paper.defs.appendChild(j);J.SET_ATTRS(y,{"clip-path":"url(#"+j.id+")"});s.clip=z;}if(!v){var AC=E.getElementById(y.getAttribute("clip-path").replace(/(^url\(#|\)$)/g,V));AC&&AC.parentNode.removeChild(AC);J.SET_ATTRS(y,{"clip-path":V});delete s.clip;}break;case"path":if(s.type=="path"){var AD="M0,0";if(v){AD=J.pathToAbsolute(v);}J.SET_ATTRS(y,{d:AD});}break;case"width":y.setAttribute(x,v);if(u.fx){x="x";v=u.x;}else{break;}case"x":if(u.fx){v=-u.x-(u.width||0);}case"rx":if(x=="rx"&&s.type=="rect"){break;}case"cx":p&&(x=="x"||x=="cx")&&(p[1]+=v-u[x]);y.setAttribute(x,v);s.pattern&&J.UPDATE_POSITION(s);break;case"height":y.setAttribute(x,v);if(u.fy){x="y";v=u.y;}else{break;}case"y":if(u.fy){v=-u.y-(u.height||0);}case"ry":if(x=="ry"&&s.type=="rect"){break;}case"cy":p&&(x=="y"||x=="cy")&&(p[2]+=v-u[x]);y.setAttribute(x,v);s.pattern&&J.UPDATE_POSITION(s);break;case"r":if(s.type=="rect"){J.SET_ATTRS(y,{rx:v,ry:v});}else{y.setAttribute(x,v);}break;case"src":if(s.type=="image"){y.setAttributeNS(s.paper.xlink,"href",v);}break;case"stroke-width":y.style.strokeWidth=v;y.setAttribute(x,v);if(u["stroke-dasharray"]){m(s,u["stroke-dasharray"]);}break;case"stroke-dasharray":m(s,v);break;case"translation":var n=String(v).split(L);n[0]=+n[0]||0;n[1]=+n[1]||0;if(p){p[1]+=n[0];p[2]+=n[1];}J.translate.call(s,n[0],n[1]);break;case"scale":n=String(v).split(L);s.scale(+n[0]||1,+n[1]||+n[0]||1,isNaN(parseFloat(n[2]))?null:+n[2],isNaN(parseFloat(n[3]))?null:+n[3]);break;case G:var l=String(v).match(e);if(l){j=J.CREATE_ELEMENT("pattern");var t=J.CREATE_ELEMENT("image");j.id=U.guid();J.SET_ATTRS(j,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1});J.SET_ATTRS(t,{x:0,y:0});t.setAttributeNS(s.paper.xlink,"href",l[1]);j.appendChild(t);var AF=E.createElement("img");AF.style.cssText="position: absolute; left: -9999em; top: -9999em";AF.onload=function(){var AG={width:this.offsetWidth,height:this.offsetHeight};J.SET_ATTRS(j,AG);J.SET_ATTRS(t,AG);E.body.removeChild(this);s.paper.safari();};E.body.appendChild(AF);AF.src=l[1];s.paper.defs.appendChild(j);y.style.fill="url(#"+j.id+")";J.SET_ATTRS(y,{fill:"url(#"+j.id+")"});s.pattern=j;s.pattern&&J.UPDATE_POSITION(s);break;}var AA=c.getRGB(v);if(!AA.error){delete AE.gradient;delete u.gradient;if(!F(u.opacity)&&F(AE.opacity)){J.SET_ATTRS(y,{opacity:u.opacity});}if(!F(u["fill-opacity"])&&F(AE["fill-opacity"])){J.SET_ATTRS(y,{"fill-opacity":u["fill-opacity"]});}}else{if((b.hasOwnProperty(s.type)||String(v).charAt(0)!="r")&&h.addGradientFill(y,v,s.paper)){u.gradient=v;u.fill="none";break;}}if(AA.hasOwnProperty("o")){J.SET_ATTRS(y,{"fill-opacity":AA.o>1?AA.o/100:AA.o});}case"stroke":AA=c.getRGB(v);y.setAttribute(x,AA.hex);if(x=="stroke"&&AA.hasOwnProperty("o")){J.SET_ATTRS(y,{"stroke-opacity":AA.o>1?AA.o/100:AA.o});}break;case"gradient":if(b.hasOwnProperty(s.type)||String(v).charAt(0)!="r"){h.addGradientFill(y,v,s.paper);}break;case"opacity":if(u.gradient&&!u.hasOwnProperty("stroke-opacity")){J.SET_ATTRS(y,{"stroke-opacity":v>1?v/100:v});}case"fill-opacity":if(u.gradient){var A=E.getElementById(y.getAttribute(G).replace(/^url\(#|\)$/g,V));if(A){var o=A.getElementsByTagName("stop");o[o.length-1].setAttribute("stop-opacity",v);}break;}default:if(x=="font-size"){v=parseInt(v,10)+"px";}var r=x.replace(/(\-.)/g,function(AG){return d.call(AG.substring(1));});y.style[r]=v;y.setAttribute(x,v);break;}}}J.TUNE_TEXT(s,AE);if(p){s.rotate(p.join(D));}else{parseFloat(q)&&s.rotate(q,true);}},remove:function(){var A=this;var j=A.get("contentBox");j.removeChild(A.canvas);for(var k in A){if(S.hasOwnProperty(k)){A[k]=J.removed(k);}}}};S._uiSetWidth=function(i){var A=this;R.superclass._uiSetWidth.apply(A,arguments);A.canvas.setAttribute("width",i);};S._uiSetHeight=function(i){var A=this;R.superclass._uiSetHeight.apply(A,arguments);A.canvas.setAttribute("height",i);};H.createElement=function(j,i){var A=this;A[0]=j;A.id=U.guid();A.node=j;A.paper=i;A.attrs=A.attrs||{};A.transformations=[];this._={tx:0,ty:0,rt:{deg:0,cx:0,cy:0},sx:1,sy:1};if(!i.bottom){i.bottom=A;}A.prev=i.top;if(i.top){i.top.next=A;}i.top=A;A.next=null;};H.rotate=function(j,i,l){var A=this;if(A.removed){return A;}if(j==null){if(A._.rt.cx){return[A._.rt.deg,A._.rt.cx,A._.rt.cy].join(D);}return A._.rt.deg;}var k=A.getRegion();j=String(j).split(L);if(j.length-1){i=parseFloat(j[1]);l=parseFloat(j[2]);}j=parseFloat(j[0]);if(i!=null){A._.rt.deg=j;}else{A._.rt.deg+=j;}(l==null)&&(i=null);A._.rt.cx=i;A._.rt.cy=l;i=i==null?k.x+k.width/2:i;l=l==null?k.y+k.height/2:l;if(A._.rt.deg){A.transformations[0]=U.substitute("rotate({0} {1} {2})",[A._.rt.deg,i,l]);if(A.clip){J.SET_ATTRS(A.clip,{transform:U.substitute("rotate({0} {1} {2})",[-A._.rt.deg,i,l])});}}else{A.transformations[0]=V;if(A.clip){J.SET_ATTRS(A.clip,{transform:V});}}J.SET_ATTRS(A.node,{transform:A.transformations.join(D)});return A;};H.hide=function(){var A=this;!A.removed&&(A.node.style.display="none");return this;};H.show=function(){var A=this;!A.removed&&(A.node.style.display="");return A;};H.remove=function(){var A=this;if(A.removed){return;}J.tear(A,A.paper);A.node.parentNode.removeChild(A.node);for(var j in A){delete A[j];}A.removed=true;};H.getRegion=function(){var A=this;if(A.removed){return A;}if(A.type=="path"){return J.pathDimensions(A.attrs.path);}var k=false;if(A.node.style.display=="none"){A.show();k=true;}var o={};try{o=A.node.getBBox();}catch(m){}finally{o=o||{};}if(A.type=="text"){o={x:o.x,y:Infinity,width:0,height:0};for(var j=0,l=A.node.getNumberOfChars();j<l;j++){var n=A.node.getExtentOfChar(j);if(n.y<o.y){o.y=n.y;}if(n.y+n.height-o.y>o.height){o.height=n.y+n.height-o.y;}if(n.x+n.width-o.x>o.width){o.width=n.x+n.width-o.x;
}}}if(k){A.hide();}return o;};H.getBBox=H.getRegion;H.attr=function(A,p){var r=this;if(r.removed){return r;}if(A==null){var n={};for(var m in r.attrs){if(r.attrs.hasOwnProperty(m)){n[m]=r.attrs[m];}}r._.rt.deg&&(n.rotation=r.rotate());(r._.sx!=1||r._.sy!=1)&&(n.scale=r.scale());n.gradient&&n.fill=="none"&&(n.fill=n.gradient)&&delete n.gradient;return n;}if(p==null&&Q(A)){if(A=="translation"){return J.translate.call(r);}if(A=="rotation"){return r.rotate();}if(A=="scale"){return r.scale();}if(A==G&&r.attrs.fill=="none"&&r.attrs.gradient){return r.attrs.gradient;}return r.attrs[A];}if(p==null&&O(A)){var q={};for(var l=0,o=A.length;l<o;l++){q[A[l]]=r.attr(A[l]);}return q;}var k=J.applyAttributes(r,A,p);h.setFillAndStroke(r,k);return r;};H.toFront=function(){var A=this;if(A.removed){return A;}A.node.parentNode.appendChild(A.node);var i=A.paper;i.top!=A&&J.toFront(A,i);return A;};H.toBack=function(){var A=this;if(A.removed){return A;}if(A.node.parentNode.firstChild!=A.node){A.node.parentNode.insertBefore(A.node,A.node.parentNode.firstChild);J.toBack(A,A.paper);}return A;};H.insertAfter=function(i){var A=this;if(A.removed){return A;}var j=i.node||i instanceof R.Set&&i.item(i.size()).node;if(j.nextSibling){j.parentNode.insertBefore(A.node,j.nextSibling);}else{j.parentNode.appendChild(A.node);}J.insertAfter(A,i,A.paper);return A;};H.insertBefore=function(i){var A=this;if(A.removed){return A;}var j=i.node||i instanceof R.Set&&i.item(0).node;j.parentNode.insertBefore(A.node,j);J.insertBefore(A,i,A.paper);return A;};H.blur=function(i){var A=this;if(+i!==0){var j=CREATE_ELEMENT("filter");var k=CREATE_ELEMENT("feGaussianBlur");A.attrs.blur=i;j.id=U.guid();J.SET_ATTRS(k,{stdDeviation:+i||1.5});j.appendChild(k);A.paper.defs.appendChild(j);A._blur=j;J.SET_ATTRS(A.node,{filter:"url(#"+j.id+")"});}else{if(A._blur){A._blur.parentNode.removeChild(A._blur);delete A._blur;delete A.attrs.blur;}A.node.removeAttribute("filter");}};},"1.0.1",{requires:["aui-drawing-base","substitute"]});